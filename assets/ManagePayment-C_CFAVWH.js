import{d as U,e as N}from"./constants-BJ-mVNN5.js";import{y as K,z as k,e as W,f as c,h as X,r as n,c as x,o as i,a as e,w as l,b as r,F as I,j as M,k as V,i as z,l as h,t as Y,G as Z}from"./index-oCaEIrCc.js";const ee=K("payment",{state:()=>({data:null}),actions:{async getPayments(f){return await k.post("admin/payment/paymentList",f)},async getPaymentDetail(f){return await k.post("admin/payment/paymentDetail",f)},async updatePayment(f){return await k.post("admin/payment/updatePayment",f,{headers:{"Content-Type":"multipart/form-data"}})}}}),te={style:{margin:"3% auto"}},ae={style:{margin:"16px 0 16px 0","text-align":"center"}},oe={__name:"ManagePayment",setup(f){const C=ee(),F=W(),A=c(),D=c(!1),R=c([]),o=c({paymentID:null,totalPaidAmount:null,paymentMethodID:null,receiptFile:[],receipt:null,status:null}),s=c({pageNumber:1,pageSize:10,totalRecord:0,pageCount:0}),d=c({paymentID:null,orderID:null,paymentMethodID:null,status:null}),j=async()=>{d.value={},await g()},g=async()=>{const v={pageNumber:s.value.pageNumber,pageSize:s.value.pageSize,orderID:d.value.orderID,paymentMethodID:d.value.paymentMethodID,status:d.value.status},t=await C.getPayments(v);t.code===200&&(R.value=t.data.data,s.value.pageSize=t.data.pagination.pageSize,s.value.pageNumber=t.data.pagination.pageNumber,s.value.totalRecord=t.data.pagination.totalRecord)},T=async v=>{D.value=!0;const t={paymentID:v},p=await C.getPaymentDetail(t);p.code===200&&(o.value=p.data)},$=async v=>{await v.validate();const t={paymentID:o.value.paymentID,totalPaidAmount:o.value.totalPaidAmount,paymentMethodID:o.value.paymentMethodID,receiptFile:o.value.receiptFile,status:o.value.status},p=await C.updatePayment(t);p.code===200&&(F.success(p.message),D.value=!1,await g())};return X(g),(v,t)=>{const p=n("el-input"),u=n("el-col"),w=n("el-option"),S=n("el-select"),b=n("el-button"),m=n("el-row"),B=n("el-divider"),_=n("el-table-column"),L=n("el-tag"),O=n("el-icon"),E=n("el-table"),q=n("el-pagination"),G=n("el-card"),P=n("el-form-item"),Q=n("el-image"),H=n("el-form"),J=n("el-dialog");return i(),x(I,null,[e(G,{header:"Payment List",style:{margin:"7% 3%","min-width":"500px",height:"800px","text-align":"left"}},{default:l(()=>[e(m,{gutter:20},{default:l(()=>[e(u,{span:6},{default:l(()=>[r("div",null,[t[13]||(t[13]=r("span",null,"Payment ID",-1)),e(p,{type:"text",modelValue:d.value.paymentID,"onUpdate:modelValue":t[0]||(t[0]=a=>d.value.paymentID=a),placeholder:"Paste the ID here...",clearable:""},null,8,["modelValue"])])]),_:1}),e(u,{span:6},{default:l(()=>[t[14]||(t[14]=r("span",null,"Order ID",-1)),r("div",null,[e(p,{type:"text",modelValue:d.value.orderID,"onUpdate:modelValue":t[1]||(t[1]=a=>d.value.orderID=a),placeholder:"Paste the ID here...",clearable:""},null,8,["modelValue"])])]),_:1}),e(u,{span:6},{default:l(()=>[t[15]||(t[15]=r("span",null,"Payment Method",-1)),r("div",null,[e(S,{modelValue:d.value.paymentMethodID,"onUpdate:modelValue":t[2]||(t[2]=a=>d.value.paymentMethodID=a),placeholder:"--- Payment Method ---"},{default:l(()=>[(i(!0),x(I,null,M(V(U),(a,y)=>(i(),z(w,{key:y,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])]),_:1}),e(u,{span:6},{default:l(()=>[t[16]||(t[16]=r("span",null,"Payment Status",-1)),r("div",null,[e(S,{modelValue:d.value.status,"onUpdate:modelValue":t[3]||(t[3]=a=>d.value.status=a),placeholder:"--- Payment Status ---"},{default:l(()=>[(i(!0),x(I,null,M(V(N),(a,y)=>(i(),z(w,{key:y,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])]),_:1}),e(u,{span:24,style:{display:"flex","justify-content":"flex-start","margin-top":"20px"}},{default:l(()=>[e(b,{type:"success",style:{border:"none",width:"90px"},size:"large",onClick:g},{default:l(()=>t[17]||(t[17]=[h("Search")])),_:1}),e(b,{type:"danger",style:{border:"none",width:"90px"},size:"large",onClick:j},{default:l(()=>t[18]||(t[18]=[h("Reset")])),_:1})]),_:1})]),_:1}),e(B),e(m,null,{default:l(()=>[e(E,{data:R.value,height:"333",style:{width:"100%"},stripe:""},{default:l(()=>[e(_,{prop:"paymentID",label:"Payment ID","flex-grow":1}),e(_,{prop:"orderID",label:"Order ID","flex-grow":1,"show-overflow-tooltip":""}),e(_,{prop:"totalPaidAmount",label:"Total Paid Amount","flex-grow":1,formatter:a=>`RM ${a.totalPaidAmount.toFixed(2)}`},null,8,["formatter"]),e(_,{prop:"paymentMethodID",label:"Payment Method","flex-grow":1,formatter:a=>`${a.paymentMethodID===1?"Cash On Delivery":"QR Code"}`},null,8,["formatter"]),e(_,{prop:"status",label:"Status","flex-grow":1},{default:l(({row:a})=>[e(L,{type:a.status==="Paid"?"success":"primary"},{default:l(()=>[h(Y(a.status),1)]),_:2},1032,["type"])]),_:1}),e(_,{label:"Action","flex-grow":1},{default:l(({row:a})=>[e(b,{type:"primary",style:{color:"white"},onClick:y=>T(a.paymentID)},{default:l(()=>[e(O,null,{default:l(()=>[e(V(Z))]),_:1})]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1}),e(m,null,{default:l(()=>[r("div",te,[e(q,{"current-page":s.value.pageNumber,"onUpdate:currentPage":t[4]||(t[4]=a=>s.value.pageNumber=a),"page-size":s.value.pageSize,"onUpdate:pageSize":t[5]||(t[5]=a=>s.value.pageSize=a),layout:"total, sizes, prev, pager, next, jumper","page-sizes":[10,50,100],size:s.value.pageSize,total:s.value.totalRecord,"hide-on-single-page":s.value.pageCount===1&&s.value.totalRecord<=10,onCurrentChange:g,onSizeChange:g},null,8,["current-page","page-size","size","total","hide-on-single-page"])])]),_:1})]),_:1}),e(J,{modelValue:D.value,"onUpdate:modelValue":t[12]||(t[12]=a=>D.value=a),title:"Edit Payment",width:"600",style:{"text-align":"center"}},{footer:l(()=>[r("div",ae,[e(b,{type:"primary",onClick:t[10]||(t[10]=a=>$(A.value))},{default:l(()=>t[19]||(t[19]=[h("Save")])),_:1}),e(b,{onClick:t[11]||(t[11]=a=>D.value=!1)},{default:l(()=>t[20]||(t[20]=[h("Cancel")])),_:1})])]),default:l(()=>[e(H,{ref_key:"editPaymentFormRef",ref:A,model:o.value},{default:l(()=>[e(m,{gutter:20},{default:l(()=>[e(u,{span:6,style:{"justify-items":"right"}},{default:l(()=>[e(P,{label:"Payment ID"})]),_:1}),e(u,{span:17},{default:l(()=>[e(p,{disabled:"",modelValue:o.value.paymentID,"onUpdate:modelValue":t[6]||(t[6]=a=>o.value.paymentID=a),placeholder:"000",style:{height:"40px"}},null,8,["modelValue"])]),_:1})]),_:1}),e(m,{gutter:20},{default:l(()=>[e(u,{span:6,style:{"justify-items":"right"}},{default:l(()=>[e(P,{label:"Payment Method ID",prop:"paymentMethodID"})]),_:1}),e(u,{span:17},{default:l(()=>[e(S,{modelValue:o.value.paymentMethodID,"onUpdate:modelValue":t[7]||(t[7]=a=>o.value.paymentMethodID=a),placeholder:"--- Select Payment Method ---",style:{height:"40px"}},{default:l(()=>[(i(!0),x(I,null,M(V(U),(a,y)=>(i(),z(w,{key:y,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(m,{gutter:20},{default:l(()=>[e(u,{span:6,style:{"justify-items":"right"}},{default:l(()=>[e(P,{label:"Total Paid Amount",prop:"totalPaidAmount"})]),_:1}),e(u,{span:17},{default:l(()=>[e(p,{modelValue:o.value.totalPaidAmount,"onUpdate:modelValue":t[8]||(t[8]=a=>o.value.totalPaidAmount=a),placeholder:"xxx xxx xxx",style:{height:"40px"}},null,8,["modelValue"])]),_:1})]),_:1}),e(m,{gutter:20},{default:l(()=>[e(u,{span:6,style:{"justify-items":"right"}},{default:l(()=>[e(P,{label:"Receipt"})]),_:1}),e(u,{span:17},{default:l(()=>[e(Q,{src:o.value.receipt},null,8,["src"])]),_:1})]),_:1}),e(m,{gutter:20},{default:l(()=>[e(u,{span:6,style:{"justify-items":"right"}},{default:l(()=>[e(P,{label:"Status"})]),_:1}),e(u,{span:17},{default:l(()=>[e(S,{modelValue:o.value.status,"onUpdate:modelValue":t[9]||(t[9]=a=>o.value.status=a),placeholder:"--- Select Payment Status ---",style:{height:"40px"}},{default:l(()=>[(i(!0),x(I,null,M(V(N),(a,y)=>(i(),z(w,{key:y,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])],64)}}};export{oe as default};
