import{y as we,z as V,e as xe,p as be,f as y,h as ce,r as o,c as R,o as b,a as l,w as a,b as m,l as c,k as _,I as _e,t as W,i as C,G as Ve,fa as Ue,fb as he,fc as Ne,F as I,j as $,fd as Ce}from"./index-Bt2_kKyI.js";import{b as O,R as Q}from"./constants-BJ-mVNN5.js";const De=we("user",{state:()=>({error:null,data:null}),actions:{async getUsers(d){return await V.post("admin/user/userList",d)},async getUserDetails(d){return await V.post("admin/user/userDetails",d)},async registerUser(d){return await V.post("admin/user/createUser",d,{headers:{"Content-Type":"multipart/form-data"}})},async updateUserDetails(d){return await V.post("admin/user/updateUser",d,{headers:{"Content-Type":"multipart/form-data"}})},async banUser(d){return await V.post("admin/user/revoke-user",d)},async reinstateUser(d){return await V.post("admin/user/reinstate-user",d)},async resetPassword(d){return await V.post("admin/user/reset-password",d)},async getOrderSummaries(){const d=await V.get("order/orderSummaries");return this.data=d.data,d.data}}}),Pe={style:{margin:"3% auto"}},ze={style:{margin:"16px 0 16px 0","text-align":"center"}},ke={style:{margin:"16px 0 16px 0","text-align":"center"}},Re={style:{"font-size":"1rem"}},Ie={style:{margin:"16px 0 16px 0","text-align":"center"}},Ge={__name:"ManageAccount",setup(d){const U=De(),D=xe(),P=be(),Z=y([]),z=y(!1),S=y(!1),j=y(),L=y(),i=y({userID:"",userName:"",email:"",phoneNumber:"",userGender:"",residentialCollege:"",address:""}),u=y({email:"",password:"",confirmPassword:"",userName:"",phoneNumber:"",gender:"",address:"",userGender:"",residentialCollege:"",paymentQRCode:[]}),g=y({pageNumber:1,pageSize:10,totalRecord:0,pageCount:0}),f=y({userID:null,userName:null,email:null,phoneNumber:null}),H=y({email:[{required:!0,message:"Please input Email Address",trigger:"blur"},{pattern:/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/,message:"Please enter a valid email address",trigger:"blur"}],password:[{required:!0,message:"Please input Password",trigger:"blur"},{pattern:/^(?=.*[a-z])(?=.*[A-Z])(?=.*[\W_]).*$/,message:"Password must include uppercase, lowercase, and special character",trigger:"blur"}],confirmPassword:[{required:!0,message:"Please confirm your Password",trigger:"blur"},{pattern:/^(?=.*[a-z])(?=.*[A-Z])(?=.*[\W_]).*$/,message:"Password must include uppercase, lowercase, and special character",trigger:"blur"},{validator:(r,e,s)=>{e!==u.value.password?s(new Error("Passwords do not match")):s()},trigger:"blur"}],userName:[{required:!0,message:"Please input Username",trigger:"blur"}],phoneNumber:[{required:!0,message:"Please input Phone Number",trigger:"blur"}],address:[{required:!0,message:"Please input Address",trigger:"blur"}],userGender:[{required:!0,message:"Please select your gender",trigger:"change"}],residentialCollege:[{required:!0,message:"Please choose your Residential College",trigger:"change"}]}),T=y(""),A=y(!1),G=y({userID:"",email:""}),J=async()=>{f.value={},await k()},k=async()=>{const r={pageNumber:g.value.pageNumber,pageSize:g.value.pageSize,userID:f.value.userID,userName:f.value.userName,email:f.value.email,phoneNumber:f.value.phoneNumber},e=await U.getUsers(r);e.code===200&&(Z.value=e.data.data,g.value.pageNumber=e.data.pagination.pageNumber,g.value.pageSize=e.data.pagination.pageSize,g.value.totalRecord=e.data.pagination.totalRecord,g.value.pageCount=e.data.pagination.pageCount)},K=async r=>{const e={userID:r},s=await U.getUserDetails(e);s.code===200&&(i.value=s.data)},X=async()=>{const r=await U.registerUser(u.value);r.code===200&&(D.success(r.message),setTimeout(()=>{P.go(0)},1500))},Y=async()=>{const r=await U.updateUserDetails(i.value);r.code===200&&(D.success(r.message),setTimeout(()=>{P.go(0)},1500))},ee=async r=>{z.value=!0,await K(r)},le=()=>{S.value=!0},ae=r=>{S.value=!1,r.resetFields()},te=async r=>{await r.validate(),await X()},se=async r=>{z.value=!1,await r.validate(),await Y()},re=async r=>{const e={userID:r},s=await U.banUser(e);s.code===200&&(D.success(s.message),setTimeout(()=>{P.go(0)},1500))},oe=async r=>{const e={userID:r},s=await U.reinstateUser(e);s.code===200&&(D.success(s.message),setTimeout(()=>{P.go(0)},1500))},ue=async()=>{const r={userID:G.value.userID,password:T.value},e=await U.resetPassword(r);e.code===200&&(D.success(e.message),setTimeout(()=>{P.go(0)},1500))},ne=(r,e)=>{A.value=!0,G.value.userID=r,G.value.email=e};return ce(k),(r,e)=>{const s=o("el-input"),n=o("el-col"),v=o("el-button"),w=o("el-row"),de=o("el-divider"),h=o("el-icon"),N=o("el-table-column"),ie=o("el-tag"),q=o("el-tooltip"),pe=o("el-dropdown-item"),me=o("el-dropdown-menu"),ge=o("el-dropdown"),fe=o("el-table"),ve=o("el-pagination"),ye=o("el-card"),p=o("el-form-item"),E=o("el-option"),F=o("el-select"),M=o("el-form"),B=o("el-dialog");return b(),R(I,null,[l(ye,{header:"User List",style:{margin:"7% 3%","min-width":"500px",height:"800px","text-align":"left"}},{default:a(()=>[l(w,{gutter:20},{default:a(()=>[l(n,{span:6},{default:a(()=>[m("div",null,[e[30]||(e[30]=m("span",null,"User ID",-1)),l(s,{type:"text",modelValue:f.value.userID,"onUpdate:modelValue":e[0]||(e[0]=t=>f.value.userID=t),placeholder:"Paste the ID here...",clearable:""},null,8,["modelValue"])])]),_:1}),l(n,{span:6},{default:a(()=>[e[31]||(e[31]=m("span",null,"User Name",-1)),m("div",null,[l(s,{type:"text",modelValue:f.value.userName,"onUpdate:modelValue":e[1]||(e[1]=t=>f.value.userName=t),placeholder:"Paste the name here...",clearable:""},null,8,["modelValue"])])]),_:1}),l(n,{span:6},{default:a(()=>[e[32]||(e[32]=m("span",null,"Email Address",-1)),m("div",null,[l(s,{type:"text",modelValue:f.value.email,"onUpdate:modelValue":e[2]||(e[2]=t=>f.value.email=t),placeholder:"abc@gmail.com"},null,8,["modelValue"])])]),_:1}),l(n,{span:6},{default:a(()=>[e[33]||(e[33]=m("span",null,"Phone Number",-1)),m("div",null,[l(s,{type:"text",modelValue:f.value.phoneNumber,"onUpdate:modelValue":e[3]||(e[3]=t=>f.value.phoneNumber=t),placeholder:"01xxxxxxxx"},null,8,["modelValue"])])]),_:1}),l(n,{span:24,style:{display:"flex","justify-content":"flex-start","margin-top":"20px"}},{default:a(()=>[l(v,{type:"success",style:{border:"none",width:"90px"},size:"large",onClick:k},{default:a(()=>e[34]||(e[34]=[c("Search")])),_:1}),l(v,{type:"danger",style:{border:"none",width:"90px"},size:"large",onClick:J},{default:a(()=>e[35]||(e[35]=[c("Reset")])),_:1})]),_:1})]),_:1}),l(de),l(w,{style:{"justify-content":"right",margin:"2% 0"}},{default:a(()=>[l(v,{type:"success",style:{border:"none",width:"120px"},size:"large",onClick:le},{default:a(()=>[l(h,{style:{display:"flex","align-items":"center"}},{default:a(()=>[l(_(_e))]),_:1}),e[36]||(e[36]=m("span",{style:{"font-size":"1rem"}},"User",-1))]),_:1})]),_:1}),l(w,null,{default:a(()=>[l(fe,{data:Z.value,height:"333",style:{width:"100%"},stripe:""},{default:a(()=>[l(N,{prop:"userID",label:"User ID","flex-grow":1,"show-overflow-tooltip":""}),l(N,{prop:"userName",label:"User Name","flex-grow":1}),l(N,{prop:"email",label:"Email Address","flex-grow":1}),l(N,{prop:"phoneNumber",label:"Phone Number","flex-grow":1}),l(N,{prop:"status",label:"Status","flex-grow":1},{default:a(({row:t})=>[l(ie,{type:t.status==="Active"?"success":"danger"},{default:a(()=>[c(W(t.status),1)]),_:2},1032,["type"])]),_:1}),l(N,{label:"Action","flex-grow":1},{default:a(t=>[l(v,{onClick:x=>ee(t.row.userID),type:"primary",style:{color:"white"}},{default:a(()=>[l(h,null,{default:a(()=>[l(_(Ve))]),_:1})]),_:2},1032,["onClick"]),t.row.status==="Active"?(b(),C(q,{key:0,content:"Ban User",placement:"top"},{default:a(()=>[l(v,{type:"danger",style:{color:"white","margin-right":"12px"},onClick:x=>re(t.row.userID)},{default:a(()=>[l(h,null,{default:a(()=>[l(_(Ue))]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)):(b(),C(q,{key:1,content:"Reinstate User",placement:"top"},{default:a(()=>[l(v,{type:"success",style:{color:"white","margin-right":"12px"},onClick:x=>oe(t.row.userID)},{default:a(()=>[l(h,null,{default:a(()=>[l(_(he))]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)),l(ge,{placement:"bottom-end"},{dropdown:a(()=>[l(me,null,{default:a(()=>[l(pe,{onClick:x=>ne(t.row.userID,t.row.email)},{default:a(()=>e[37]||(e[37]=[c(" Reset Password ")])),_:2},1032,["onClick"])]),_:2},1024)]),default:a(()=>[l(v,{type:"info",style:{color:"white"}},{default:a(()=>[l(h,null,{default:a(()=>[l(_(Ne))]),_:1})]),_:1})]),_:2},1024)]),_:1})]),_:1},8,["data"])]),_:1}),l(w,null,{default:a(()=>[m("div",Pe,[l(ve,{"current-page":g.value.pageNumber,"onUpdate:currentPage":e[4]||(e[4]=t=>g.value.pageNumber=t),"page-size":g.value.pageSize,"onUpdate:pageSize":e[5]||(e[5]=t=>g.value.pageSize=t),layout:"total, sizes, prev, pager, next, jumper","page-sizes":[10,50,100],size:g.value.pageSize,total:g.value.totalRecord,"hide-on-single-page":g.value.pageCount===1&&g.value.totalRecord<=10,onCurrentChange:k,onSizeChange:k},null,8,["current-page","page-size","size","total","hide-on-single-page"])])]),_:1})]),_:1}),l(B,{modelValue:S.value,"onUpdate:modelValue":e[16]||(e[16]=t=>S.value=t),title:"Register User",width:"600"},{footer:a(()=>[m("div",ze,[l(v,{type:"primary",onClick:e[14]||(e[14]=t=>te(j.value))},{default:a(()=>e[38]||(e[38]=[c("Save")])),_:1}),l(v,{onClick:e[15]||(e[15]=t=>ae(j.value))},{default:a(()=>e[39]||(e[39]=[c("Cancel")])),_:1})])]),default:a(()=>[l(M,{ref_key:"registerUserFormRef",ref:j,model:u.value,rules:H.value,"label-width":"auto"},{default:a(()=>[l(p,{label:"Email",prop:"email"},{default:a(()=>[l(s,{modelValue:u.value.email,"onUpdate:modelValue":e[6]||(e[6]=t=>u.value.email=t),placeholder:"abc@gmail.com",style:{width:"400px",height:"40px"}},null,8,["modelValue"])]),_:1}),l(p,{label:"Password",prop:"password"},{default:a(()=>[l(s,{modelValue:u.value.password,"onUpdate:modelValue":e[7]||(e[7]=t=>u.value.password=t),type:"password","show-password":"",placeholder:"Please enter your Password",style:{width:"400px",height:"40px"}},null,8,["modelValue"])]),_:1}),l(p,{label:"Confirm Password",prop:"confirmPassword"},{default:a(()=>[l(s,{modelValue:u.value.confirmPassword,"onUpdate:modelValue":e[8]||(e[8]=t=>u.value.confirmPassword=t),type:"password","show-password":"",placeholder:"Please enter again your password",style:{width:"400px",height:"40px"}},null,8,["modelValue"])]),_:1}),l(p,{label:"User Name",prop:"userName"},{default:a(()=>[l(s,{modelValue:u.value.userName,"onUpdate:modelValue":e[9]||(e[9]=t=>u.value.userName=t),placeholder:"xxx xxx xxx",style:{width:"400px",height:"40px"}},null,8,["modelValue"])]),_:1}),l(p,{label:"Phone Number",prop:"phoneNumber"},{default:a(()=>[l(s,{modelValue:u.value.phoneNumber,"onUpdate:modelValue":e[10]||(e[10]=t=>u.value.phoneNumber=t),placeholder:"01xxxxxxxx",style:{width:"400px",height:"40px"}},null,8,["modelValue"])]),_:1}),l(p,{label:"Gender",prop:"userGender"},{default:a(()=>[l(F,{modelValue:u.value.userGender,"onUpdate:modelValue":e[11]||(e[11]=t=>u.value.userGender=t),placeholder:"Please Select Gender",size:"large",style:{width:"400px",height:"40px"}},{default:a(()=>[(b(!0),R(I,null,$(_(O),(t,x)=>(b(),C(E,{key:x,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(p,{label:"Residential College",prop:"residentialCollege"},{default:a(()=>[l(F,{modelValue:u.value.residentialCollege,"onUpdate:modelValue":e[12]||(e[12]=t=>u.value.residentialCollege=t),placeholder:"Please Select Residential College",size:"large",style:{width:"400px",height:"40px"}},{default:a(()=>[(b(!0),R(I,null,$(_(Q),(t,x)=>(b(),C(E,{key:x,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(p,{label:"Address",prop:"address"},{default:a(()=>[l(s,{label:"address",modelValue:u.value.address,"onUpdate:modelValue":e[13]||(e[13]=t=>u.value.address=t),type:"text",placeholder:"Paste address here...",style:{width:"400px",height:"40px"}},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"]),l(B,{modelValue:z.value,"onUpdate:modelValue":e[26]||(e[26]=t=>z.value=t),title:"Edit User",width:"600",style:{"text-align":"center"}},{footer:a(()=>[m("div",ke,[l(v,{type:"primary",onClick:e[24]||(e[24]=t=>se(L.value))},{default:a(()=>e[40]||(e[40]=[c("Save")])),_:1}),l(v,{onClick:e[25]||(e[25]=t=>z.value=!1)},{default:a(()=>e[41]||(e[41]=[c("Cancel")])),_:1})])]),default:a(()=>[l(M,{ref_key:"editUserDetailsFormRef",ref:L,model:i.value},{default:a(()=>[l(w,{gutter:20},{default:a(()=>[l(n,{span:6,style:{"justify-items":"right"}},{default:a(()=>[l(p,{label:"User ID"})]),_:1}),l(n,{span:17},{default:a(()=>[l(s,{disabled:"",modelValue:i.value.userID,"onUpdate:modelValue":e[17]||(e[17]=t=>i.value.userID=t),placeholder:"000",style:{height:"40px"}},null,8,["modelValue"])]),_:1})]),_:1}),l(w,{gutter:20},{default:a(()=>[l(n,{span:6,style:{"justify-items":"right"}},{default:a(()=>[l(p,{label:"User Name",prop:"userName"})]),_:1}),l(n,{span:17},{default:a(()=>[l(s,{modelValue:i.value.userName,"onUpdate:modelValue":e[18]||(e[18]=t=>i.value.userName=t),placeholder:"xxx xxx xxx",style:{height:"40px"}},null,8,["modelValue"])]),_:1})]),_:1}),l(w,{gutter:20},{default:a(()=>[l(n,{span:6,style:{"justify-items":"right"}},{default:a(()=>[l(p,{label:"Email Address",prop:"emailAddress"})]),_:1}),l(n,{span:17},{default:a(()=>[l(s,{modelValue:i.value.email,"onUpdate:modelValue":e[19]||(e[19]=t=>i.value.email=t),placeholder:"abc@gmail.com",style:{height:"40px"},disabled:""},null,8,["modelValue"])]),_:1})]),_:1}),l(w,{gutter:20},{default:a(()=>[l(n,{span:6,style:{"justify-items":"right"}},{default:a(()=>[l(p,{label:"Phone Number",prop:"phoneNumber"})]),_:1}),l(n,{span:17},{default:a(()=>[l(s,{modelValue:i.value.phoneNumber,"onUpdate:modelValue":e[20]||(e[20]=t=>i.value.phoneNumber=t),placeholder:"01xxxxxxxx",style:{height:"40px"}},null,8,["modelValue"])]),_:1})]),_:1}),l(w,{gutter:20},{default:a(()=>[l(n,{span:6,style:{"justify-items":"right"}},{default:a(()=>[l(p,{label:"Gender"})]),_:1}),l(n,{span:17},{default:a(()=>[l(F,{modelValue:i.value.userGender,"onUpdate:modelValue":e[21]||(e[21]=t=>i.value.userGender=t),placeholder:"Gender",size:"large"},{default:a(()=>[(b(!0),R(I,null,$(_(O),(t,x)=>(b(),C(E,{key:x,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(w,{gutter:20},{default:a(()=>[l(n,{span:6,style:{"justify-items":"right"}},{default:a(()=>[l(p,{label:"Residential College"})]),_:1}),l(n,{span:17},{default:a(()=>[l(F,{modelValue:i.value.residentialCollege,"onUpdate:modelValue":e[22]||(e[22]=t=>i.value.residentialCollege=t),placeholder:"Residential College",size:"large"},{default:a(()=>[(b(!0),R(I,null,$(_(Q),(t,x)=>(b(),C(E,{key:x,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(w,{gutter:20},{default:a(()=>[l(n,{span:6,style:{"justify-items":"right"}},{default:a(()=>[l(p,{label:"Address"})]),_:1}),l(n,{span:17},{default:a(()=>[l(s,{label:"address",modelValue:i.value.address,"onUpdate:modelValue":e[23]||(e[23]=t=>i.value.address=t),type:"textarea",placeholder:"Paste address here..."},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),l(B,{modelValue:A.value,"onUpdate:modelValue":e[29]||(e[29]=t=>A.value=t),width:"600",style:{"text-align":"center"}},{footer:a(()=>[m("div",Ie,[l(v,{type:"primary",onClick:ue},{default:a(()=>e[42]||(e[42]=[c("Save")])),_:1}),l(v,{onClick:e[28]||(e[28]=t=>A.value=!1)},{default:a(()=>e[43]||(e[43]=[c("Cancel")])),_:1})])]),default:a(()=>[e[44]||(e[44]=m("p",{style:{"font-size":"1.5rem","font-weight":"600"}},"Reset account password",-1)),m("p",Re," Enter a new password for "+W(G.value.email),1),l(s,{modelValue:T.value,"onUpdate:modelValue":e[27]||(e[27]=t=>T.value=t),type:"password","show-password":"",label:"New Password",placeholder:"Enter new password...",clearable:"",style:{width:"400px",height:"40px"}},{suffix:a(()=>[l(q,{content:"This action is irreversible. Please proceed with caution.",placement:"top"},{default:a(()=>[l(h,null,{default:a(()=>[l(_(Ce))]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])],64)}}};export{Ge as default};
